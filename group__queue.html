<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SELKIELogger: Message queues</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SELKIELogger
   &#160;<span id="projectnumber">0.9.18</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__queue.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Message queues<div class="ingroups"><a class="el" href="group__Library.html">SELKIELogger Library</a> &raquo; <a class="el" href="group__SELKIELoggerBase.html">Core functions and definitions</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Message queues:</div>
<div class="dyncontent">
<div class="center"><img src="group__queue.png" border="0" usemap="#agroup____queue" alt=""/></div>
<map name="agroup____queue" id="agroup____queue">
<area shape="rect" title=" " alt="" coords="197,13,328,38"/>
<area shape="rect" href="group__SELKIELoggerBase.html" title=" " alt="" coords="5,5,149,45"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmsgqueue.html">msgqueue</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represent a simple FIFO message queue.  <a href="structmsgqueue.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structqueueitem.html">queueitem</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gadf6d45e5c830acaf528fe1fe6692e81e"><td class="memItemLeft" align="right" valign="top"><a id="gadf6d45e5c830acaf528fe1fe6692e81e"></a>
typedef struct <a class="el" href="structqueueitem.html">queueitem</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__queue.html#gadf6d45e5c830acaf528fe1fe6692e81e">queueitem</a></td></tr>
<tr class="memdesc:gadf6d45e5c830acaf528fe1fe6692e81e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Each queue item is a message and pointer to the next queue entry, if any. <br /></td></tr>
<tr class="separator:gadf6d45e5c830acaf528fe1fe6692e81e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga31114938f51aa3546360472a1b001c6b"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structmsgqueue.html">msgqueue</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__queue.html#ga31114938f51aa3546360472a1b001c6b">msgqueue</a></td></tr>
<tr class="memdesc:ga31114938f51aa3546360472a1b001c6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represent a simple FIFO message queue.  <a href="group__queue.html#ga31114938f51aa3546360472a1b001c6b">More...</a><br /></td></tr>
<tr class="separator:ga31114938f51aa3546360472a1b001c6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gafdd6b0066b812ac8f85cc3174b86d236"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__queue.html#gafdd6b0066b812ac8f85cc3174b86d236">queue_init</a> (<a class="el" href="structmsgqueue.html">msgqueue</a> *queue)</td></tr>
<tr class="memdesc:gafdd6b0066b812ac8f85cc3174b86d236"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure queue structure is set to known good values and marked valid.  <a href="group__queue.html#gafdd6b0066b812ac8f85cc3174b86d236">More...</a><br /></td></tr>
<tr class="separator:gafdd6b0066b812ac8f85cc3174b86d236"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8946d0c363fc431e9c796a285e8368e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__queue.html#ga8946d0c363fc431e9c796a285e8368e8">queue_destroy</a> (<a class="el" href="structmsgqueue.html">msgqueue</a> *queue)</td></tr>
<tr class="memdesc:ga8946d0c363fc431e9c796a285e8368e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Invalidate queue and destroy all contents.  <a href="group__queue.html#ga8946d0c363fc431e9c796a285e8368e8">More...</a><br /></td></tr>
<tr class="separator:ga8946d0c363fc431e9c796a285e8368e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39d0673bfdbf0f429d742dedb1a5abe1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__queue.html#ga39d0673bfdbf0f429d742dedb1a5abe1">queue_push</a> (<a class="el" href="structmsgqueue.html">msgqueue</a> *queue, <a class="el" href="structmsg__t.html">msg_t</a> *item)</td></tr>
<tr class="memdesc:ga39d0673bfdbf0f429d742dedb1a5abe1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a message to the tail of the queue.  <a href="group__queue.html#ga39d0673bfdbf0f429d742dedb1a5abe1">More...</a><br /></td></tr>
<tr class="separator:ga39d0673bfdbf0f429d742dedb1a5abe1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga810daeec2d01206460bb58d1bcf3bf89"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__queue.html#ga810daeec2d01206460bb58d1bcf3bf89">queue_push_qi</a> (<a class="el" href="structmsgqueue.html">msgqueue</a> *queue, <a class="el" href="structqueueitem.html">queueitem</a> *item)</td></tr>
<tr class="memdesc:ga810daeec2d01206460bb58d1bcf3bf89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a queue item to the tail of the queue.  <a href="group__queue.html#ga810daeec2d01206460bb58d1bcf3bf89">More...</a><br /></td></tr>
<tr class="separator:ga810daeec2d01206460bb58d1bcf3bf89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6fa0e0fb4f1b0d3c2731edec0a08dcfc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmsg__t.html">msg_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__queue.html#ga6fa0e0fb4f1b0d3c2731edec0a08dcfc">queue_pop</a> (<a class="el" href="structmsgqueue.html">msgqueue</a> *queue)</td></tr>
<tr class="memdesc:ga6fa0e0fb4f1b0d3c2731edec0a08dcfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove topmost item from the queue and return it, if queue is not empty.  <a href="group__queue.html#ga6fa0e0fb4f1b0d3c2731edec0a08dcfc">More...</a><br /></td></tr>
<tr class="separator:ga6fa0e0fb4f1b0d3c2731edec0a08dcfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0aacb607d0dfeceef39f989c2f8e8d48"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__queue.html#ga0aacb607d0dfeceef39f989c2f8e8d48">queue_count</a> (const <a class="el" href="structmsgqueue.html">msgqueue</a> *queue)</td></tr>
<tr class="memdesc:ga0aacb607d0dfeceef39f989c2f8e8d48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Iterate over queue and return current number of items.  <a href="group__queue.html#ga0aacb607d0dfeceef39f989c2f8e8d48">More...</a><br /></td></tr>
<tr class="separator:ga0aacb607d0dfeceef39f989c2f8e8d48"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga31114938f51aa3546360472a1b001c6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga31114938f51aa3546360472a1b001c6b">&#9670;&nbsp;</a></span>msgqueue</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmsgqueue.html">msgqueue</a> <a class="el" href="structmsgqueue.html">msgqueue</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Represent a simple FIFO message queue. </p>
<p>Represents a queue of items starting at <a class="el" href="structmsgqueue.html#a36328c6f28640ef1c850f2ec3d743c6a" title="Points to first message, or NULL if empty.">msgqueue.head</a>, with the last item at or near <a class="el" href="structmsgqueue.html#acf11f82f81a2bb4c57c04472b3bc5627" title="brief Tail entry hint">msgqueue.tail</a>.</p>
<p>The queue is protected by the mutex at <a class="el" href="structmsgqueue.html#a9e7684dec248d497ddd961ec068d2d4c" title="Queue lock.">msgqueue.lock</a>, and will only have items added and removed while <a class="el" href="structmsgqueue.html#a6ce7462cbf2cb6e345488fa9495ebe1c" title="Queue status.">msgqueue.valid</a> remains true. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga0aacb607d0dfeceef39f989c2f8e8d48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0aacb607d0dfeceef39f989c2f8e8d48">&#9670;&nbsp;</a></span>queue_count()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int queue_count </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmsgqueue.html">msgqueue</a> *&#160;</td>
          <td class="paramname"><em>queue</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Iterate over queue and return current number of items. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">queue</td><td>Pointer to queue </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of items in queue, or -1 on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="queue_8c_source.html#l00219">219</a> of file <a class="el" href="queue_8c_source.html">queue.c</a>.</p>

</div>
</div>
<a id="ga8946d0c363fc431e9c796a285e8368e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8946d0c363fc431e9c796a285e8368e8">&#9670;&nbsp;</a></span>queue_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void queue_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmsgqueue.html">msgqueue</a> *&#160;</td>
          <td class="paramname"><em>queue</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Invalidate queue and destroy all contents. </p>
<p>The queue is immediately marked as invalid, and this is not undone if an error occurs.</p>
<p>Any remaining items are removed from the queue and destroyed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">queue</td><td>Pointer to queue structure to be destroyed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="queue_8c_source.html#l00064">64</a> of file <a class="el" href="queue_8c_source.html">queue.c</a>.</p>

</div>
</div>
<a id="gafdd6b0066b812ac8f85cc3174b86d236"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafdd6b0066b812ac8f85cc3174b86d236">&#9670;&nbsp;</a></span>queue_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool queue_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmsgqueue.html">msgqueue</a> *&#160;</td>
          <td class="paramname"><em>queue</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ensure queue structure is set to known good values and marked valid. </p>
<p>Will not re-initialise a queue if it is still valid or has a head or tail value set. Other threads might be able to add entries to the queue between the queue being marked valid and this function returning to the caller.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">queue</td><td>Pointer to queue structure to be initialised </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True on success, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="queue_8c_source.html#l00035">35</a> of file <a class="el" href="queue_8c_source.html">queue.c</a>.</p>

</div>
</div>
<a id="ga6fa0e0fb4f1b0d3c2731edec0a08dcfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6fa0e0fb4f1b0d3c2731edec0a08dcfc">&#9670;&nbsp;</a></span>queue_pop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmsg__t.html">msg_t</a>* queue_pop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmsgqueue.html">msgqueue</a> *&#160;</td>
          <td class="paramname"><em>queue</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove topmost item from the queue and return it, if queue is not empty. </p>
<p>Atomically remove the first entry in the queue and return it. The underlying queue item is freed, but our caller must destroy and free the message itself.</p>
<p>The queue item is freed, but the caller is responsible for destroying and freeing the message itself after use (i.e. the caller now owns the message, not the queue or the sending function).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">queue</td><td>Pointer to queue </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to previously queued message </dd></dl>

<p class="definition">Definition at line <a class="el" href="queue_8c_source.html#l00186">186</a> of file <a class="el" href="queue_8c_source.html">queue.c</a>.</p>

</div>
</div>
<a id="ga39d0673bfdbf0f429d742dedb1a5abe1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga39d0673bfdbf0f429d742dedb1a5abe1">&#9670;&nbsp;</a></span>queue_push()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool queue_push </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmsgqueue.html">msgqueue</a> *&#160;</td>
          <td class="paramname"><em>queue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmsg__t.html">msg_t</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a message to the tail of the queue. </p>
<p>Messages are wrapped into a queue item structure, and passed immediately to <a class="el" href="group__queue.html#ga810daeec2d01206460bb58d1bcf3bf89" title="Add a queue item to the tail of the queue.">queue_push_qi()</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">queue</td><td>Pointer to queue </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>Pointer to message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return value of <a class="el" href="group__queue.html#ga810daeec2d01206460bb58d1bcf3bf89" title="Add a queue item to the tail of the queue.">queue_push_qi()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="queue_8c_source.html#l00103">103</a> of file <a class="el" href="queue_8c_source.html">queue.c</a>.</p>

</div>
</div>
<a id="ga810daeec2d01206460bb58d1bcf3bf89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga810daeec2d01206460bb58d1bcf3bf89">&#9670;&nbsp;</a></span>queue_push_qi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool queue_push_qi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmsgqueue.html">msgqueue</a> *&#160;</td>
          <td class="paramname"><em>queue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structqueueitem.html">queueitem</a> *&#160;</td>
          <td class="paramname"><em>item</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a queue item to the tail of the queue. </p>
<p>Will not append to an invalid queue.</p>
<p>Once pushed to the queue, the queue owns the message embedded in <code>item</code> and the caller should not destroy or free it. That will be handled in <a class="el" href="group__queue.html#ga8946d0c363fc431e9c796a285e8368e8" title="Invalidate queue and destroy all contents.">queue_destroy()</a> or the function responsible for consuming items out of the queue.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">queue</td><td>Pointer to queue </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">item</td><td>Pointer to a queue item </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if item successfully appended to queue, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="queue_8c_source.html#l00128">128</a> of file <a class="el" href="queue_8c_source.html">queue.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
